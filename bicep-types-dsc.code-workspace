{
  "folders": [
    {
      "name": "bicep-types-dsc",
      "path": "."
    },
    {
      "name": "DSC",
      "path": "../DSC"
    },
    {
      "name": "bicep",
      "path": "../bicep"
    }
  ],
  "launch": {
    "version": "0.2.0",
    "configurations": [
      {
        "name": "Generate Types",
        "type": "node",
        "request": "launch",
        "program": "${workspaceFolder}/src/main.ts",
        "args": [
          "--debug"
        ],
        "runtimeExecutable": "tsx",
        "console": "integratedTerminal",
        "internalConsoleOptions": "neverOpen",
        "env": {
          "PATH": "${workspaceFolder:DSC}/bin/debug:${env:PATH}"
        },
      },
      {
        "name": "Attach to Rust process",
        "type": "lldb",
        "expressions": "simple",
        "request": "attach",
        "pid": "${command:pickMyProcess}",
      },
      {
        "name": "Launch dscbicep",
        "type": "lldb",
        "expressions": "simple",
        "request": "launch",
        "program": "${workspaceFolder:DSC}/bin/debug/dscbicep",
        "env": {
          "DSC_TRACE_LEVEL": "DEBUG",
        }
      }
    ],
  },
  "tasks": {
    "version": "2.0.0",
    "tasks": [
      {
        "label": "Local Deploy",
        "detail": "Runs bicep local-deploy example.bicepparam",
        "type": "shell",
        "command": "bicep local-deploy example.bicepparam",
        "options": {
          "cwd": "${workspaceFolder:bicep-types-dsc}",
          "env": {
            "BICEP_TRACING_ENABLED": "false",
            "DSC_TRACE_LEVEL": "TRACE",
            "DSC_GRPC_DEBUG": "false",
            "DSC_RESOURCE_PATH": "${workspaceFolder:DSC}/bin/debug",
            "PATH": "${workspaceFolder:DSC}/bin/debug",
          }
        },
        "presentation": {
          "reveal": "always"
        },
        "group": "test"
      },
      {
        "label": "Launch gRPC UI",
        "detail": "Runs grpcui against the gRPC server",
        "type": "shell",
        "command": "grpcui -plaintext localhost:50051",
        "group": "test"
      },
      {
        "label": "Build dscbicep",
        "detail": "Builds dscbicep gRPC server.",
        "type": "shell",
        "command": "./build.ps1 -Project dscbicep",
        "options": {
          "cwd": "${workspaceFolder:DSC}",
          "env": {
            "RUSTC_WRAPPER": "sccache"
          },
          "shell": {
            "executable": "pwsh",
            "args": [
              "-NoProfile",
              "-Command"
            ],
          },
        },
        "presentation": {
          "reveal": "always"
        },
        "group": {
          "kind": "build",
          "isDefault": false
        }
      },
      {
        "label": "Publish Extension",
        "detail": "Builds dscbicep gRPC server and publishes into Bicep extension.",
        "type": "shell",
        "command": "npm start -- --publish",
        "options": {
          "cwd": "${workspaceFolder:bicep-types-dsc}",
        },
        "dependsOn": [
          "Build dscbicep"
        ],
        "presentation": {
          "reveal": "silent"
        },
        "group": {
          "kind": "build",
          "isDefault": true
        }
      }
    ]
  },
  "settings": {
    "[typescript]": {
      "editor.defaultFormatter": "prettier.prettier-vscode"
    },
    "git.branchProtectionPrompt": "alwaysCommit",
    "editor.formatOnSave": true,
    "rust-analyzer.runnables.extraEnv": {
      "RUSTC_WRAPPER": "sccache"
    },
    "rust-analyzer.cargo.extraEnv": {
      "RUSTC_WRAPPER": "sccache"
    },
    "rust-analyzer.server.extraEnv": {
      "RUSTC_WRAPPER": "sccache"
    },
    "rust-analyzer.check.extraEnv": {
      "RUSTC_WRAPPER": "sccache"
    },
  },
  "extensions": {
    "recommendations": [
      "dbaeumer.vscode-eslint",
      "prettier.prettier-vscode",
      "vadimcn.vscode-lldb",
    ],
  },
}
